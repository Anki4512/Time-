<!DOCTYPE html>
<html>
<head>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <style>@media print { .no-print { display: none !important; } .shadow-2xl { box-shadow: none; border: 1px solid #ddd; } }</style>
</head>
<body class="bg-slate-50 p-4 sm:p-10">
    <div class="animate__animated animate__fadeIn max-w-6xl mx-auto bg-white rounded-[2rem] shadow-2xl border border-slate-200 overflow-hidden">
        
        <div class="p-8 flex flex-col md:flex-row justify-between items-center bg-white/50 backdrop-blur-md gap-4 no-print">
            <div>
                <h1 class="text-3xl font-black text-slate-800 tracking-tighter italic uppercase">Weekly Insights</h1>
                <p class="text-slate-400 font-mono text-sm">Real-time team overview</p>
            </div>
            <div class="flex items-center gap-3">
                <button onclick="window.print()" class="flex items-center gap-2 bg-slate-800 text-white px-5 py-3 rounded-2xl shadow-lg hover:bg-slate-700 transition-all">
                    <span>ðŸ“„</span> <span class="font-bold text-sm">PDF</span>
                </button>
                <button onclick="shareDashboard()" class="flex items-center gap-2 bg-indigo-600 text-white px-5 py-3 rounded-2xl shadow-lg hover:bg-indigo-700 transition-all">
                    <span>ðŸ“¤</span> <span class="font-bold text-sm">Share</span>
                </button>
                <button onclick="location.reload()" class="bg-white border p-3 rounded-2xl shadow-sm">ðŸ”„</button>
            </div>
        </div>

        <div class="overflow-x-auto p-4">
            <table class="w-full border-separate border-spacing-2">
                <thead>
                    <tr>
                        <th class="p-4 text-slate-400 uppercase text-xs font-bold text-left">Date</th>
                        {% for emp in employees %}
                        <th class="p-4 bg-indigo-50 rounded-2xl text-center text-indigo-700 font-black text-sm uppercase">{{ emp }}</th>
                        {% endfor %}
                    </tr>
                </thead>
                <tbody>
                    {% for date in dates %}
                    <tr>
                        <td class="p-4 font-bold text-slate-700 text-sm">{{ date }}</td>
                        {% for emp in employees %}
                        <td class="p-4 text-center bg-slate-50 rounded-2xl font-mono font-bold text-indigo-600">
                            {{ report[emp][date] if date in report[emp] else 'â€”' }}
                        </td>
                        {% endfor %}
                    </tr>
                    {% endfor %}
                </tbody>
                <tfoot class="bg-slate-900 text-white">
                    <tr>
                        <td class="p-5 font-black uppercase text-xs">Employee Totals</td>
                        {% set grand_total = namespace(value=0) %}
                        {% for emp in employees %}
                            <td class="p-5 text-center font-mono text-lg text-green-400 font-black">
                                {% set emp_total = report[emp].values()|sum|round(2) %}
                                {{ emp_total }}
                                {% set grand_total.value = grand_total.value + emp_total %}
                            </td>
                        {% endfor %}
                    </tr>
                    <tr class="bg-indigo-900">
                        <td class="p-3 text-right text-xs uppercase font-bold text-indigo-300">Company Sum</td>
                        <td colspan="{{ employees|length }}" class="p-3 text-center text-xl font-black text-white">
                            {{ grand_total.value|round(2) }} hrs
                        </td>
                    </tr>
                </tfoot>
            </table>
        </div>
    </div>

    <script>
        async function shareDashboard() {
            const shareData = { title: 'Time Report', text: 'Weekly hours summary.', url: window.location.href };
            try { await navigator.share(shareData); } catch (err) { alert('Use PDF to share manually!'); }
        }
    </script>
</body>
</html>
